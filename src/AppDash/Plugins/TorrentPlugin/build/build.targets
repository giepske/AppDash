<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!--
  <UsingTask
    TaskName="Test"
    TaskFactory="CodeTaskFactory"
    AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll" >
    <ParameterGroup />
    <Task>
      <Reference Include="$(TargetDir)\$(TargetFileName)"/>
      <Using Namespace="System"/>
      <Using Namespace="$(RootNamespace)"/>
      <Code Type="Fragment" Language="cs">
        <![CDATA[
        Log.LogError("Test");
        ]]>
      </Code>
    </Task>
  </UsingTask>
  -->

  <Target Name="CreatePluginFolderTask" AfterTargets="PostBuildEvent">
    <PropertyGroup>
      <PackageDirectory>$(TargetDir)$(TargetName)</PackageDirectory>
    </PropertyGroup>

    <ItemGroup>
      <IconFiles Include="$(TargetDir)icons\*.*" />
    </ItemGroup>

    <!-- <Test /> -->

    <RemoveDir Directories="$(PackageDirectory)"/>
    <MakeDir Directories="$(PackageDirectory)"/>
    <Copy SourceFiles="$(TargetDir)$(TargetFileName)" DestinationFolder="$(PackageDirectory)"/>
    <Copy SourceFiles="@(IconFiles)" DestinationFolder="$(PackageDirectory)\icons"/>
    <Message Text="=================================================================="  Importance="high" />
    <Message Text="Created plugin folder in: $(PackageDirectory)"  Importance="high" />
    <Message Text="=================================================================="  Importance="high" />
  </Target>
</Project>